# Concert client tuples are of the platform-system-robot-name-app where
# the name is just a placemarker for the eventual concert client name.
# All other parts of the tuple are fixed.

name: "Cafe Concert"
nodes:
  - id: cafe_database
    tuple: linux.ros.pc.cafe_rapps/cafe_database
#  - id: cafe_taskcoordinator
#    tuple: linux.ros.pc.cafe_manager/taskcoordinator

  - id: waiterbot
    tuple: linux.ros.pc.cafe_rapps/waiter_soft
#  - id: waiterbot2
#    tuple: linux.ros.pc.waiterbot/waiter_soft
#  - id: waiterbot3
#    tuple: linux.ros.pc.waiterbot/waiter_soft
topics:
## Cafe database - Waiterbot
  - id: cafe_database_waiterbot_map
    type: nav_msgs/OccupancyGrid
  - id: cafe_database_waiterbot_map_metadata
    type: nav_msgs/MapMetaData
  - id: cafe_database_waiterbot_table_pose_list
    type: semantic_region_handler/TablePoseList
  - id: cafe_database_waiterbot_ar_marker_list
    type: ar_track_alvar/AlvarMarkers

## Task Coordinator - Kitchen Manager
#  - id: taskcoordinator_kitchen_list_order
#    type: cafe_msgs/OrderList


actions:
## Task Coordinator - User Device
#  - id: taskcoordinator_userdevice_send_order
#    type: cafe_msgs/UserOrder
## Task Coordinator - Waiterbot
  - id: taskcoordinator_waiterbot_delivery_order
    type: cafe_msgs/DeliveryOrder


edges:
## Cafe database
  - start: cafe_database
    finish: cafe_database_waiterbot_map 
    remap_from: map
    remap_to: map
  - start: cafe_database
    finish: cafe_database_waiterbot_map_metadata
    remap_from: map_metadata
    remap_to: map_metadata
  - start: cafe_database
    finish: cafe_database_waiterbot_table_pose_list
    remap_from: table_pose_list
    remap_to: cafe_database/table_pose_list
  - start: cafe_database
    finish: cafe_database_waiterbot_ar_marker_list
    remap_from: ar_marker_list 
    remap_to: cafe_database/ar_marker_list

## Waiter
  - start: cafe_database_waiterbot_map
    finish: waiterbot
    remap_from: map
    remap_to: map
  - start: cafe_database_waiterbot_map_metadata
    finish: waiterbot
    remap_from: map_metadata
    remap_to: map_metadata
  - start: cafe_database_waiterbot_table_pose_list
    finish: waiterbot
    remap_from: table_pose_list
    remap_to: cafe_database/table_pose_list
  - start: cafe_database_waiterbot_ar_marker_list
    finish: waiterbot
    remap_from: ar_marker_list
    remap_to: cafe_database/ar_marker_list
  - start: waiterbot
    finish: taskcoordinator_waiterbot_delivery_order
    remap_from: delivery_order
    remap_to: waiterbot/delivery_order

## Task Coordinator
# - start: taskcoordinator_waiterbot_delivery_order
#   finish: taskcoordinator
#   remap_from: delievery_order
#   remap_to: delievery_order
# - start:  taskcoordinator
#   finish: taskcoordinator_userdevice_send_order
#   remap_from: send_order
#   remap_to: send_order
# - start: taskcoordinator
#   finish: taskcoordinator_kitchen_list_order
#   remap_from: list_order
#   remap_to: list_order

## Kitchen Manager
